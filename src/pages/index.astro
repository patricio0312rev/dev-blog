---
import { getCollection } from "astro:content";
import BaseLayout from "@/layouts/BaseLayout.astro";
import HomePage from "@/views/HomePage";

const articles = await getCollection("articles", ({ data }) => !data.draft);
const recentArticles = articles
  .sort((a, b) => b.data.publishDate.valueOf() - a.data.publishDate.valueOf())
  .slice(0, 3)
  .map((article) => ({
    slug: article.slug,
    title: article.data.title,
    description: article.data.description,
    category: article.data.category,
    tags: article.data.tags,
    date: article.data.publishDate.toISOString(),
  }));
---

<BaseLayout title="Home">
  <HomePage articles={recentArticles} client:load />
</BaseLayout>
