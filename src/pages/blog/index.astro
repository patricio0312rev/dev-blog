---
import { getCollection } from "astro:content";
import BaseLayout from "@/layouts/BaseLayout.astro";
import BlogListPage from "@/views/BlogListPage";
import { normalizeDateInput } from "@/utils";

const articles = await getCollection("articles", ({ data }) => !data.draft);

const sortedArticles = articles
  .sort(
    (a, b) =>
      normalizeDateInput(b.data.publishDate).getTime() -
      normalizeDateInput(a.data.publishDate).getTime()
  )
  .map((article) => ({
    slug: article.slug,
    title: article.data.title,
    description: article.data.description,
    category: article.data.category,
    tags: article.data.tags,
    date: article.data.publishDate,
    heroImage: article.data.heroImage,
    heroImageAlt: article.data.heroImageAlt,
  }));
---

<BaseLayout
  title="Articles"
  description="Software development insights, tutorials, and occasional hot takes."
>
  <BlogListPage articles={sortedArticles} client:load />
</BaseLayout>
